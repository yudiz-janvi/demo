<!DOCTYPE html>
<html lang="en">

<head>
    <title>Create Collection | NFT Talent</title>
    <%- include('css-lib.ejs') %>
</head>

<body>
    <div class="loader">
        <div class="loader-img">
            <img src="/assets/img/loader-logo.png" alt="Loading">
        </div>
    </div>

    <!--=======================================
            Modal Start Here
    ========================================-->

    <%- include('sidebar.ejs') %>

        <!--=======================================
                Modal End Here
    ========================================-->

        <!--=======================================
                Navbar Start Here
    ========================================-->

        <div class="main-hero">
            <div class="hero-main-inr"><%- include('navbar.ejs') %></div>
        </div>

        <!--=======================================
                Navbar End Here
    ========================================-->

        <!-- TODO: Body goes here -->

        <div class="live-acution-home2">
            <div class="container-fluid">
                <div class="live-auction-inr">
                    <div class="heading-otr">
                        <div class="head-otr">
                            <h3 class="heading heading-h3">Create Collection</h3>
                        </div>
                    </div>
                    <span class="line"></span>
                    <div class="create-collection-otr">
                        <div class="create-collection-img">
                            <div id="uploadArea" class="upload-area">
                                <div class="upload-area__header">
                                    <p class="upload-area__title"></p>
                                    <p class="upload-area__paragraph">
                                        <strong class="upload-area__tooltip">
                                            <span class="upload-area__tooltip-data"></span>
                                        </strong>
                                    </p>
                                </div>
                                <div id="dropZoon" class="upload-area__drop-zoon drop-zoon">
                                    <span class="drop-zoon__icon">
                                        <img src="/assets/img/create-upload.svg" alt="upload">
                                    </span>
                                    <p class="desc body-sb">
                                        JPG, WEBP, JPEG, PNG & GIF. Max 5 MB.
                                    </p>
                                    <p class="drop-zoon__paragraph btn-outline1">
                                        Browse
                                    </p>
                                    <span id="loadingText" class="drop-zoon__loading-text">Please Wait</span>
                                    <div class="img-main">
                                        <img src="../assets/img/user-Image15.jpg" alt="Preview Image" id="previewImage"
                                            class="drop-zoon__preview-image" draggable="false" />
                                    </div>
                                    <input type="file" id="fileInput" class="drop-zoon__file-input" accept="image/*" />
                                    <div id="imageUpload-error" class="desc body-sb"></div>
                                </div>
                                <div id="fileDetails" class="upload-area__file-details file-details">
                                    <h3 class="file-details__title">
                                        Uploaded File
                                    </h3>
                                    <div id="uploadedFile" class="uploaded-file">
                                        <div class="uploaded-file__icon-container">
                                            <i class="bx bxs-file-blank uploaded-file__icon"></i>
                                            <span class="uploaded-file__icon-text"></span>
                                        </div>
                                        <div id="uploadedFileInfo" class="uploaded-file__info">
                                            <span class="uploaded-file__name">Project 1</span>
                                            <span class="uploaded-file__counter">0%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="collection-details">
                            <div class="input-otr">
                                <label for="">Name:</label>
                                <input class="input" type="text" name="name" id="txt-colleciton-name">
                                <div id="nftName-error"></div>
                            </div>
                            <div class="input-otr">
                                <label for="">Description:</label>
                                <textarea name="description" id="txt-collection-description" class="input"></textarea>
                                <div id="geohash-error"></div>
                            </div>

                        </div>

                        <input type="button" class="btn-fill btn-create" id="create-collection"
                            value="Create">Request</input>
                    </div>


                </div>
            </div>
        </div>
        </div>

        <!-- =======================================
            Footer & Copyright Section Start Here
        ========================================-->

        <%- include('footer.ejs') %>


            <!--=======================================
            Footer & Copyright Section End Here
        ========================================-->

            <script>
                const uploadArea = document.querySelector('#uploadArea');
                const dropZoon = document.querySelector('#dropZoon');
                const loadingText = document.querySelector('#loadingText');
                const fileInput = document.querySelector('#fileInput');
                const previewImage = document.querySelector('#previewImage');
                const fileDetails = document.querySelector('#fileDetails');
                const uploadedFile = document.querySelector('#uploadedFile');
                const uploadedFileInfo =
                    document.querySelector('#uploadedFileInfo');
                const uploadedFileName = document.querySelector(
                    '.uploaded-file__name'
                );
                const uploadedFileIconText = document.querySelector(
                    '.uploaded-file__icon-text'
                );
                const uploadedFileCounter = document.querySelector(
                    '.uploaded-file__counter'
                );
                const toolTipData = document.querySelector(
                    '.upload-area__tooltip-data'
                );
                const imagesTypes = ['jpeg', 'webp', 'png', 'svg', 'gif'];

                toolTipData.innerHTML = [...imagesTypes].join(', .');

                dropZoon.addEventListener('dragover', function (event) {
                    event.preventDefault();
                    dropZoon.classList.add('drop-zoon--over');
                });

                dropZoon.addEventListener('dragleave', function (event) {
                    dropZoon.classList.remove('drop-zoon--over');
                });

                dropZoon.addEventListener('drop', function (event) {
                    event.preventDefault();

                    dropZoon.classList.remove('drop-zoon--over');
                    const file = event.dataTransfer.files[0];

                    uploadFile(file);
                });

                dropZoon.addEventListener('click', function (event) {
                    fileInput.click();
                });

                fileInput.addEventListener('change', function (event) {
                    const file = event.target.files[0];
                    uploadFile(file);
                });

                function uploadFile(file) {
                    const fileReader = new FileReader();
                    const fileType = file.type;
                    const fileSize = file.size;

                    if (fileValidate(fileType, fileSize)) {
                        dropZoon.classList.add('drop-zoon--Uploaded');

                        loadingText.style.display = 'block';
                        previewImage.style.display = 'none';
                        uploadedFile.classList.remove('uploaded-file--open');
                        uploadedFileInfo.classList.remove(
                            'uploaded-file__info--active'
                        );

                        fileReader.addEventListener('load', function () {
                            setTimeout(function () {
                                uploadArea.classList.add('upload-area--open');
                                loadingText.style.display = 'none';
                                previewImage.style.display = 'block';

                                fileDetails.classList.add('file-details--open');
                                uploadedFile.classList.add('uploaded-file--open');
                                uploadedFileInfo.classList.add(
                                    'uploaded-file__info--active'
                                );
                            }, 500);

                            previewImage.setAttribute('src', fileReader.result);
                            uploadedFileName.innerHTML = file.name;
                            $('#uploadArea').removeClass('err-dashed');
                            progressMove();
                        });

                        fileReader.readAsDataURL(file);
                    } else {
                        this;
                    }
                }

                function progressMove() {
                    let counter = 0;
                    setTimeout(() => {
                        let counterIncrease = setInterval(() => {
                            if (counter === 100) {
                                clearInterval(counterIncrease);
                            } else {
                                counter = counter + 10;
                                uploadedFileCounter.innerHTML = `${counter}%`;
                            }
                        }, 100);
                    }, 600);
                }

                function fileValidate(fileType, fileSize) {
                    let isImage = imagesTypes.filter(
                        (type) => fileType.indexOf(`image/${type}`) !== -1
                    );
                    if (isImage[0] === 'jpeg') {
                        uploadedFileIconText.innerHTML = 'jpg';
                    } else {
                        uploadedFileIconText.innerHTML = isImage[0];
                    }

                    if (isImage.length !== 0) {
                        if (fileSize <= 15 * 1024 * 1024) {
                            return true;
                        } else {
                            return notify(
                                'error',
                                'Please Your File Should be 15 Megabytes or Less'
                            );
                        }
                    } else {
                        return notify(
                            'error',
                            'Please make sure to upload An Image File Type'
                        );
                    }
                }
            </script>

            <script src="/user/js/create-collection.js"></script>

</body>

</html>